if (self.CavalryLogger) { CavalryLogger.start_js(["MBA4t"]); }

__d("NotesReaderOverlay",["ActorURI","AsyncRequest","BanzaiLogger","CampfireLoggerEvents","CampfireLoggerNoteTypes","DOM","DOMContainer.react","LayerDestroyOnHide","LayerHideOnEscape","LayerHideOnTransition","LayerRefocusOnHide","NotesReader.react","PageTransitions","React","ReactDOM","TypewriterLayer","URI","XNotesComposerController","goURI"],(function(a,b,c,d,e,f){__p&&__p();function a(a,c){"use strict";this.$12=function(){this.$13(),this.$6.show()}.bind(this),this.$1=a,this.$2=c,this.$3=b("DOM").create("div"),this.$4=null,this.$5=null,this.$6=new(b("TypewriterLayer"))({addedBehaviors:[b("LayerDestroyOnHide"),b("LayerHideOnEscape"),b("LayerHideOnTransition"),b("LayerRefocusOnHide")],causalElement:c.causalElement},this.$3),this.$6.subscribe("hide",this.$7.bind(this)),this.$8(),!this.$2.canEdit&&this.$2.published&&(this.$9=Date.now())}a.prototype.$7=function(){"use strict";__p&&__p();b("PageTransitions").removeHandler(this.$10);this.$10=null;var a=function(c){var d=this.$4;this.$4=null;b("PageTransitions").removeHandler(a);if(d.getPath()===c.getPath()){b("PageTransitions").transitionComplete(!0);return!0}return!1}.bind(this);b("PageTransitions").registerHandler(a);b("goURI")(this.$4);if(!this.$2.canEdit&&this.$2.published){var c=Date.now(),d=Math.round((c-this.$9)/1e3);b("BanzaiLogger").log("CampfireNotesLoggerConfig",{event:b("CampfireLoggerEvents").CONSUME_READER_EXIT_PUBLISHED,event_time:c,note_id:Number(this.$1),note_type:b("CampfireLoggerNoteTypes").CAMPFIRE,author_id:Number(this.$2.authorInfo.ownerID),time_spent_reading_sec:d})}};a.prototype.$11=function(){"use strict";var a=b("XNotesComposerController").getURIBuilder().getURI();a=b("ActorURI").create(a,this.$2.authorInfo.ownerID);new(b("AsyncRequest"))(a).setData({note_id:this.$1}).setMethod("POST").setHandler(function(){this.$6.hide()}.bind(this)).send()};a.prototype.$8=function(){"use strict";b("ReactDOM").render(b("React").createElement(b("NotesReader.react"),{authorInfo:this.$2.authorInfo,canEdit:this.$2.canEdit,coverMediaInfo:this.$2.coverMediaInfo,feedTracking:this.$2.feedTracking,noteID:this.$1,title:this.$2.title,menuMarkup:this.$2.menuMarkup,onEdit:this.$11.bind(this),ownerID:this.$2.authorInfo.ownerID,permalinkURI:this.$2.permalinkURI,privacyMarkup:this.$2.privacyMarkup,ufiMarkup:this.$2.ufiMarkup,testConfig:this.$2.testConfig,viewCount:this.$2.viewCount},b("React").createElement(b("DOMContainer.react"),{display:"block"},this.$2.documentMarkup)),this.$3,this.$12)};a.prototype.$13=function(){"use strict";__p&&__p();var a=new(b("URI"))(this.$2.permalinkURI);this.$5=function(c){__p&&__p();if(a.getPath()===c.getPath()){b("PageTransitions").transitionComplete(!0);return!0}if(this.$6.isShown()&&this.$4.getPath()===c.getPath()){b("PageTransitions").removeHandler(this.$5);this.$5=null;this.$4=null;b("PageTransitions").transitionComplete(!0);return!0}this.$5=null;return!1}.bind(this);b("PageTransitions").registerHandler(this.$5);this.$4=b("URI").getRequestURI();b("goURI")(a)};e.exports=a}),null);